#scale_y_continuous(limits = c(0,100))+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1), legend.position = "none", plot.title = element_text(hjust = 0.5))
plotPositiveSwabs
theme_set(theme_bw())
plotIntensive <- ggplot() +
geom_line(data = df, aes(x = data, y = terapia_intensiva, color="Places occupied in intensive care", group = 1)) +
geom_line(data = df, aes(x = data, y = ricoverati_con_sintomi, color="hospitalised with symptoms", group = 1)) +
labs(title = "Hospitalised and places occupied in intensive terapy", x = "Time", y = "Number of places occupied") +
scale_x_date(date_breaks = '5 days',
date_labels = '%Y-%m-%d') +
#scale_y_continuous(limits = c(0,100))+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1), plot.title = element_text(hjust = 0.5))
plotIntensive
plotSummary <- ggplot() +
geom_line(data = df, aes(x = data, y = nuovi_positivi, color="Positives", group = 1))+
geom_line(data = df, aes(x = data, y = nuovi_deceduti, color="Deaths", group = 1))+
geom_line(data = df, aes(x = data, y = nuove_intensive, color="Intensive care", group = 1))+
geom_line(data = df, aes(x = data, y = nuovi_ricoveri, color="Hospitalised with symptoms", group = 1)) +
labs(title = "Summary of covid situation between 1/10/20 and 31/02/21", x = "Time", y = "Cases") +
scale_x_date(date_breaks = '5 days',
date_labels = '%Y-%m-%d') +
#scale_y_continuous(trans = "log10")+
#scale_y_continuous(limits = c(0,100))+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1), plot.title = element_text(hjust = 0.5))
plotSummary
plotOtherSummary <- ggplot() +
geom_line(data = df, aes(x = data, y = totale_positivi, color="Positives", group = 1))+
geom_line(data = df, aes(x = data, y = deceduti, color="Deaths", group = 1))+
geom_line(data = df, aes(x = data, y = terapia_intensiva, color="Intensive care", group = 1))+
geom_line(data = df, aes(x = data, y = ricoverati_con_sintomi, color="Hospitalised with symptoms", group = 1)) +
labs(title = "Summary of covid situation between 1/10/20 and 31/02/21", x = "Time", y = "Cases") +
scale_x_date(date_breaks = '5 days',
date_labels = '%Y-%m-%d') +
scale_y_continuous(trans = "log10")+
#scale_y_continuous(limits = c(0,100))+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1), plot.title = element_text(hjust = 0.5))
plotOtherSummary
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
##################
#### Project SMSD
##################
library(ggplot2)
#load data
df_global <- data.frame(read.csv("https://raw.githubusercontent.com/pcm-dpc/
COVID-19/master/dati-regioni/dpc-covid19-ita-regioni.csv"))
#read data we are interested in
#then those that are relative to the following coupla of parameters:
#regione: Sicilia
#data:  1st October 2020 to 1st February 2021
df_sicily_secondwave <- df_global[which(df_global$denominazione_regione == "Sicilia" & (df_global$data >= "2020-09-30T10:00:00" & df_global$data <= "2021-02-01T10:00:00")), ]
#df_em <-df_global[which(df_global$denominazione_regione == "Emilia-Romagna" & (df_global$data >= "2021-10-01T10:00:00" & df_global$data <= "2022-01-01T10:00:00")), ]
################
# clean dataset
################
# remove unuseful columns
df <- df_sicily_secondwave[ , -which(names(df_sicily_secondwave) %in% c("stato", "codice_regione", "denominazione_regione", "lat", "long", "note"))]
df <- df[ , -c(17:24)]
# add column accounting for the number of new swabs carried out
for(x in 2:nrow(df)) {
df$nuovi_tamponi[x] <- df$tamponi[x] - df$tamponi[x-1]
}
# add column for new death per day
for(x in 2:nrow(df)){
df$nuovi_deceduti[x] <- df$deceduti[x] - df$deceduti[x-1]
}
for(x in 2:nrow(df)){
df$nuovi_ricoveri[x] <- df$ricoverati_con_sintomi[x] - df$ricoverati_con_sintomi[x-1]
}
for(x in 2:nrow(df)){
df$nuove_intensive[x] <- df$terapia_intensiva[x] - df$terapia_intensiva[x-1]
}
df$ricoverati_con_sintomi
df$nuovi_deceduti
# remove first row
df <- df[-1,]
#index reordering
row.names(df) <- NULL
#add color
df$color <-NA
df$color[1:36]<-"bianco"
df$color[c(37:59, 89:91, 101:108)]<-rep("arancione",34)
df$color[c(60:84,99,100)]<-rep("giallo",27)
df$color[c(85:88,92:95,96,97,98, 109:123)]<-rep("rosso",25)
############################
### 1.Perform some explanatory analysis for your data, especially by use of graphical tools.
############################
df$data <- as.Date(df$data,  "%Y-%m-%d")
# see how the number of positives changes over time
ggplot() +
geom_line(data = df, aes(x = data, y = nuovi_positivi, color="nuovi positivi", group = 1)) +
geom_point(data = df, aes(x = data, y = nuovi_positivi, color="nuovi positivi", group = 1))+
labs(x = "Time", y = "New positives") +
scale_x_date(date_breaks = '5 days',
date_labels = '%Y-%m-%d') +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
# see how the number of swabs carried out changes over time
ggplot() +
geom_line(data = df, aes(x = data, y = tamponi, group = 1)) +
geom_point(data = df, aes(x = data, y = tamponi, group = 1)) +
labs(x = "Time", y = "Swabs") +
scale_x_date(date_breaks = '5 days',
date_labels = '%Y-%m-%d') +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
#########################
### 2.Describe the quality of the data and discuss whether and how a plausible statistical model could be posed.
#########################
# check for missing values in the data frame
na_count <- sapply(df, function(y) sum(length(which(is.na(y)))))
na_count <- data.frame(na_count)
source("~/.active-rstudio-document", echo=TRUE)
ggplot() +
geom_point(data = df, aes(x = data, y = nuovi_positivi, color="nuovi positivi", group = 1),col=c("#fc6b03","#cfcaca","#f2d729","#b3190b")[unclass(as.factor(df$color))])+
#geom_line(data = df, aes(x = data, y = predict(loess_1,type="response"), color = "LOESS model 1", group = 1), size = 0.75) +
#geom_line(data = df, aes(x = data, y = predict(loess_2,type="response"), color = "LOESS model 2", group = 1), size = 0.75) +
#geom_line(data = df, aes(x = data, y = predict(loess_3,type="response"), color = "LOESS model 3", group = 1), size = 0.75) +
geom_line(data = df, aes(x = data, y = predict(loess_0,type="response"), color = "LOESS model 0", group = 1), size = 0.75)
ggplot() +
geom_point(data = df, aes(x = data, y = nuovi_positivi, color="nuovi positivi", group = 1),col=c("#fc6b03","#cfcaca","#f2d729","#b3190b")[unclass(as.factor(df$color))])+
#geom_line(data = df, aes(x = data, y = predict(loess_1,type="response"), color = "LOESS model 1", group = 1), size = 0.75) +
#geom_line(data = df, aes(x = data, y = predict(loess_2,type="response"), color = "LOESS model 2", group = 1), size = 0.75) +
#geom_line(data = df, aes(x = data, y = predict(loess_3,type="response"), color = "LOESS model 3", group = 1), size = 0.75) +
geom_line(data = df, aes(x = data, y = predict(loess_0,type="response"), color = "LOESS model 0", group = 1), size = 0.75)
df_extended <- data.frame(read.csv("sicily_secondwave_covid.csv"))
df_extended$data <- as.Date(df_extended$data,  "%Y-%m-%d")
df <- df_extended[which(df_extended$data >= "2020-10-01" & df_extended$data <= "2021-01-31"),]
df$data <- as.Date(df$data,  "%Y-%m-%d")
col_zone <- c("#fc6b03","#cfcaca","#f2d729","#b3190b")
df
library(ggplot2)
for(x in 1:123){
if (df$color[x] == "bianco") {
df$colorAsNum[x] = 10
}
if (df$color[x] == "giallo") {
df$colorAsNum[x] = 20
}
if (df$color[x] == "arancione") {
df$colorAsNum[x] = 30
}
if (df$color[x] == "rosso") {
df$colorAsNum[x] = 40
}
}
continuous_color <- function() {
new_color <- NA
previous = ""
current = "bianco"
l <- df_extended$color
count <- 0
for (i in 1:length(l)) {
if(l[i] == "bianco") {
new_color[i] = 0
previous = "bianco"
current = "bianco"
}
else if(l[i] == "rosso") {
decrease = 1*0.5
new_color[i] = new_color[i-1] + decrease
if(current != "rosso") {
previous = current
current = "rosso"
}
}
else if(l[i] == "giallo") {
if(previous == "arancione" || previous  == "rosso"){
decrease = -1*0.5
new_color[i] = new_color[i-1] + decrease
}
else {
decrease = 1*0.5
new_color[i] = new_color[i-1] + decrease
}
if(current != "giallo") {
previous = current
current = "giallo"
}
}
else {
if(previous == "rosso") {
decrease = -1*0.5
}
else {
decrease = 1*0.5
}
new_color[i] =  new_color[i-1] + decrease
if(current != "arancione") {
previous = current
current = "arancione"
}
}
}
l <- new_color
return(l)
}
library(raster)
new_color_extended <- continuous_color()
new_color <- new_color[1:123]
library(ggplot2)
for(x in 1:123){
if (df$color[x] == "bianco") {
df$colorAsNum[x] = 10
}
if (df$color[x] == "giallo") {
df$colorAsNum[x] = 20
}
if (df$color[x] == "arancione") {
df$colorAsNum[x] = 30
}
if (df$color[x] == "rosso") {
df$colorAsNum[x] = 40
}
}
continuous_color <- function() {
new_color <- NA
previous = ""
current = "bianco"
l <- df_extended$color
count <- 0
for (i in 1:length(l)) {
if(l[i] == "bianco") {
new_color[i] = 0
previous = "bianco"
current = "bianco"
}
else if(l[i] == "rosso") {
decrease = 1*0.5
new_color[i] = new_color[i-1] + decrease
if(current != "rosso") {
previous = current
current = "rosso"
}
}
else if(l[i] == "giallo") {
if(previous == "arancione" || previous  == "rosso"){
decrease = -1*0.5
new_color[i] = new_color[i-1] + decrease
}
else {
decrease = 1*0.5
new_color[i] = new_color[i-1] + decrease
}
if(current != "giallo") {
previous = current
current = "giallo"
}
}
else {
if(previous == "rosso") {
decrease = -1*0.5
}
else {
decrease = 1*0.5
}
new_color[i] =  new_color[i-1] + decrease
if(current != "arancione") {
previous = current
current = "arancione"
}
}
}
l <- new_color
return(l)
}
library(raster)
new_color_extended <- continuous_color()
new_color <- new_color[1:123]
library(raster)
new_color_extended <- continuous_color()
new_color
library(raster)
new_color_extended <- continuous_color()
df$new_color <- new_color
loess_0 <- loess(nuovi_positivi ~ as.numeric(data), data = df, span = 0.1)
loess_1 <- loess(nuovi_positivi ~ ricoverati_con_sintomi + nuovi_tamponi_pcr, data = df, span = 0.1)
loess_2 <- loess_modAdd <- loess(nuovi_positivi ~ ricoverati_con_sintomi + nuovi_tamponi_pcr + new_color, data = df, span = 0.6)
new_color <- cotinuous_color()
new_color <- continuous_color()
df$new_color <- new_color
new_color <- new_color[1:123]
df$new_color <- new_color
df$new_color <- new_color
df_extended$new_color <- new_color_extended
df_extended$var_workplace_prev
loess_0 <- loess(nuovi_positivi ~ as.numeric(data), data = df, span = 0.1)
loess_1 <- loess(nuovi_positivi ~ ricoverati_con_sintomi + nuovi_tamponi_pcr, data = df, span = 0.1)
loess_2 <- loess_modAdd <- loess(nuovi_positivi ~ ricoverati_con_sintomi + nuovi_tamponi_pcr + new_color, data = df, span = 0.6)
loess_3 <- loess_modAdd <- loess(nuovi_positivi ~ ricoverati_con_sintomi + nuovi_tamponi_pcr + new_color + var_workplace, data = df, span = 0.6)
ggplot() +
geom_point(data = df, aes(x = data, y = nuovi_positivi, color="nuovi positivi", group = 1),col=c("#fc6b03","#cfcaca","#f2d729","#b3190b")[unclass(as.factor(df$color))])+
#geom_line(data = df, aes(x = data, y = predict(loess_1,type="response"), color = "LOESS model 1", group = 1), size = 0.75) +
#geom_line(data = df, aes(x = data, y = predict(loess_2,type="response"), color = "LOESS model 2", group = 1), size = 0.75) +
#geom_line(data = df, aes(x = data, y = predict(loess_3,type="response"), color = "LOESS model 3", group = 1), size = 0.75) +
geom_line(data = df, aes(x = data, y = predict(loess_0,type="response"), color = "LOESS model 0", group = 1), size = 0.75)
install.packages("MLmetrics")
library(MLmetrics)
MAPE(predict(loess_0), df$nuovi_positivi)
loess_0_pred <- loess(nuovi_positivi ~ as.numeric(data), data = df_extended, span = 0.1)
predict(loess_0_pred)
MAPE(predict(loess_0_pred), df_extended$nuovi_positivi)
MAPE(predict(loess_0_pred)[123:137], df_extended$nuovi_positivi[123:137])
MAPE(predict(loess_0_pred)[124:137], df_extended$nuovi_positivi[124:137])
as.numeric(data)
as.numeric(df$data)
as.numeric(df$data)
1*10*2020
as.numeric(df$data)
1*10*2020
1970*365*50
365*50
predict(loess_0, newdata = df_extended)
loess_mod_prev <- loess(nuovi_positivi ~ ricoverati_con_sintomi_prev + nuovi_tamponi_pcr_prev + new_color_extended + var_workplace_prev, data = df_extended, span = 0.9)
ggplot() +
geom_point(data = df_extended, aes(x = data, y = nuovi_positivi, color="nuovi positivi", group = 1), col=c("#fc6b03","#cfcaca","#f2d729","#b3190b")[unclass(as.factor(df_extended$color))])+
geom_line(data = df_extended, aes(x = data, y = predict(loess_mod_prev,type="response"), color = "LOESS model predictor", group = 1)) +
geom_smooth(data = df_extended, aes(x = data, y = predict(loess_mod_prev,type="response"), color = "LOESS model predictor", group = 1)) +
scale_x_date(date_breaks = '5 days',
date_labels = '%Y-%m-%d') +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
ggplot() +
geom_point(data = df_extended, aes(x = data, y = nuovi_positivi, color="nuovi positivi", group = 1), col=c("#fc6b03","#cfcaca","#f2d729","#b3190b")[unclass(as.factor(df_extended$color))])+
geom_line(data = df_extended, aes(x = data, y = predict(loess_mod_prev,type="response"), color = "LOESS model predictor", group = 1)) +
#geom_smooth(data = df_extended, aes(x = data, y = predict(loess_mod_prev,type="response"), color = "LOESS model predictor", group = 1)) +
scale_x_date(date_breaks = '5 days',
date_labels = '%Y-%m-%d') +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
loess_mod_prev <- loess(nuovi_positivi ~ ricoverati_con_sintomi_prev + nuovi_tamponi_pcr_prev + new_color_extended + var_workplace_prev, data = df_extended, span = 0.9)
ggplot() +
geom_point(data = df_extended, aes(x = data, y = nuovi_positivi, color="nuovi positivi", group = 1), col=c("#fc6b03","#cfcaca","#f2d729","#b3190b")[unclass(as.factor(df_extended$color))])+
geom_line(data = df_extended, aes(x = data, y = predict(loess_mod_prev,type="response"), color = "LOESS model predictor", group = 1)) +
#geom_smooth(data = df_extended, aes(x = data, y = predict(loess_mod_prev,type="response"), color = "LOESS model predictor", group = 1)) +
scale_x_date(date_breaks = '5 days',
date_labels = '%Y-%m-%d') +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
loess_mod_prev <- loess(nuovi_positivi ~ ricoverati_con_sintomi_prev + nuovi_tamponi_pcr_prev + new_color_extended , data = df_extended, span = 0.9)
ggplot() +
geom_point(data = df_extended, aes(x = data, y = nuovi_positivi, color="nuovi positivi", group = 1), col=c("#fc6b03","#cfcaca","#f2d729","#b3190b")[unclass(as.factor(df_extended$color))])+
geom_line(data = df_extended, aes(x = data, y = predict(loess_mod_prev,type="response"), color = "LOESS model predictor", group = 1)) +
#geom_smooth(data = df_extended, aes(x = data, y = predict(loess_mod_prev,type="response"), color = "LOESS model predictor", group = 1)) +
scale_x_date(date_breaks = '5 days',
date_labels = '%Y-%m-%d') +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
loess_mod_prev <- loess(nuovi_positivi ~ ricoverati_con_sintomi_prev  + new_color_extended + var_workplace_prev, data = df_extended, span = 0.9)
ggplot() +
geom_point(data = df_extended, aes(x = data, y = nuovi_positivi, color="nuovi positivi", group = 1), col=c("#fc6b03","#cfcaca","#f2d729","#b3190b")[unclass(as.factor(df_extended$color))])+
geom_line(data = df_extended, aes(x = data, y = predict(loess_mod_prev,type="response"), color = "LOESS model predictor", group = 1)) +
#geom_smooth(data = df_extended, aes(x = data, y = predict(loess_mod_prev,type="response"), color = "LOESS model predictor", group = 1)) +
scale_x_date(date_breaks = '5 days',
date_labels = '%Y-%m-%d') +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
loess_mod_prev <- loess(nuovi_positivi ~ ricoverati_con_sintomi_prev , data = df_extended, span = 0.9)
ggplot() +
geom_point(data = df_extended, aes(x = data, y = nuovi_positivi, color="nuovi positivi", group = 1), col=c("#fc6b03","#cfcaca","#f2d729","#b3190b")[unclass(as.factor(df_extended$color))])+
geom_line(data = df_extended, aes(x = data, y = predict(loess_mod_prev,type="response"), color = "LOESS model predictor", group = 1)) +
#geom_smooth(data = df_extended, aes(x = data, y = predict(loess_mod_prev,type="response"), color = "LOESS model predictor", group = 1)) +
scale_x_date(date_breaks = '5 days',
date_labels = '%Y-%m-%d') +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
loess_mod_prev <- loess(nuovi_positivi ~ ricoverati_con_sintomi_prev + nuovi_tamponi_pcr_prev + , data = df_extended, span = 0.9)
loess_mod_prev <- loess(nuovi_positivi ~ ricoverati_con_sintomi_prev + nuovi_tamponi_pcr_prev , data = df_extended, span = 0.9)
ggplot() +
geom_point(data = df_extended, aes(x = data, y = nuovi_positivi, color="nuovi positivi", group = 1), col=c("#fc6b03","#cfcaca","#f2d729","#b3190b")[unclass(as.factor(df_extended$color))])+
geom_line(data = df_extended, aes(x = data, y = predict(loess_mod_prev,type="response"), color = "LOESS model predictor", group = 1)) +
#geom_smooth(data = df_extended, aes(x = data, y = predict(loess_mod_prev,type="response"), color = "LOESS model predictor", group = 1)) +
scale_x_date(date_breaks = '5 days',
date_labels = '%Y-%m-%d') +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
loess_mod_prev <- loess(nuovi_positivi ~ ricoverati_con_sintomi_prev + var_workplace_prev, data = df_extended, span = 0.9)
ggplot() +
geom_point(data = df_extended, aes(x = data, y = nuovi_positivi, color="nuovi positivi", group = 1), col=c("#fc6b03","#cfcaca","#f2d729","#b3190b")[unclass(as.factor(df_extended$color))])+
geom_line(data = df_extended, aes(x = data, y = predict(loess_mod_prev,type="response"), color = "LOESS model predictor", group = 1)) +
geom_smooth(data = df_extended, aes(x = data, y = predict(loess_mod_prev,type="response"), color = "LOESS model predictor", group = 1)) +
scale_x_date(date_breaks = '5 days',
date_labels = '%Y-%m-%d') +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
loess_mod_prev <- loess(nuovi_positivi ~ ricoverati_con_sintomi_prev + nuovi_tamponi_pcr_prev + new_color_extended + var_workplace_prev, data = df_extended, span = 0.9)
ggplot() +
geom_point(data = df_extended, aes(x = data, y = nuovi_positivi, color="nuovi positivi", group = 1), col=c("#fc6b03","#cfcaca","#f2d729","#b3190b")[unclass(as.factor(df_extended$color))])+
geom_line(data = df_extended, aes(x = data, y = predict(loess_mod_prev,type="response"), color = "LOESS model predictor", group = 1)) +
#geom_smooth(data = df_extended, aes(x = data, y = predict(loess_mod_prev,type="response"), color = "LOESS model predictor", group = 1)) +
scale_x_date(date_breaks = '5 days',
date_labels = '%Y-%m-%d') +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
loess_mod_prev <- loess(nuovi_positivi ~ ricoverati_con_sintomi_prev + nuovi_tamponi_pcr_prev  + var_workplace_prev, data = df_extended, span = 0.9)
ggplot() +
geom_point(data = df_extended, aes(x = data, y = nuovi_positivi, color="nuovi positivi", group = 1), col=c("#fc6b03","#cfcaca","#f2d729","#b3190b")[unclass(as.factor(df_extended$color))])+
geom_line(data = df_extended, aes(x = data, y = predict(loess_mod_prev,type="response"), color = "LOESS model predictor", group = 1)) +
#geom_smooth(data = df_extended, aes(x = data, y = predict(loess_mod_prev,type="response"), color = "LOESS model predictor", group = 1)) +
scale_x_date(date_breaks = '5 days',
date_labels = '%Y-%m-%d') +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
loess_mod_prev <- loess(nuovi_positivi ~ ricoverati_con_sintomi_prev + nuovi_tamponi_pcr_prev + new_color_extended + var_workplace_prev, data = df_extended, span = 0.9)
ggplot() +
geom_point(data = df_extended, aes(x = data, y = nuovi_positivi, color="nuovi positivi", group = 1), col=c("#fc6b03","#cfcaca","#f2d729","#b3190b")[unclass(as.factor(df_extended$color))])+
geom_line(data = df_extended, aes(x = data, y = predict(loess_mod_prev,type="response"), color = "LOESS model predictor", group = 1)) +
#geom_smooth(data = df_extended, aes(x = data, y = predict(loess_mod_prev,type="response"), color = "LOESS model predictor", group = 1)) +
scale_x_date(date_breaks = '5 days',
date_labels = '%Y-%m-%d') +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
loess_mod_prev <- loess(nuovi_positivi ~ nuovi_tamponi_pcr_prev + new_color_extended + var_workplace_prev, data = df_extended, span = 0.9)
ggplot() +
geom_point(data = df_extended, aes(x = data, y = nuovi_positivi, color="nuovi positivi", group = 1), col=c("#fc6b03","#cfcaca","#f2d729","#b3190b")[unclass(as.factor(df_extended$color))])+
geom_line(data = df_extended, aes(x = data, y = predict(loess_mod_prev,type="response"), color = "LOESS model predictor", group = 1)) +
#geom_smooth(data = df_extended, aes(x = data, y = predict(loess_mod_prev,type="response"), color = "LOESS model predictor", group = 1)) +
scale_x_date(date_breaks = '5 days',
date_labels = '%Y-%m-%d') +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
loess_mod_prev <- loess(nuovi_positivi ~ ricoverati_con_sintomi_prev + nuovi_tamponi_pcr_prev + new_color_extended + var_workplace_prev, data = df_extended, span = 0.9)
ggplot() +
geom_point(data = df_extended, aes(x = data, y = nuovi_positivi, color="nuovi positivi", group = 1), col=c("#fc6b03","#cfcaca","#f2d729","#b3190b")[unclass(as.factor(df_extended$color))])+
geom_line(data = df_extended, aes(x = data, y = predict(loess_mod_prev,type="response"), color = "LOESS model predictor", group = 1)) +
#geom_smooth(data = df_extended, aes(x = data, y = predict(loess_mod_prev,type="response"), color = "LOESS model predictor", group = 1)) +
scale_x_date(date_breaks = '5 days',
date_labels = '%Y-%m-%d') +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
loess_mod_prev <- loess(nuovi_positivi ~ ricoverati_con_sintomi_prev + nuovi_tamponi_pcr_prev + new_color_extended , data = df_extended, span = 0.9)
ggplot() +
geom_point(data = df_extended, aes(x = data, y = nuovi_positivi, color="nuovi positivi", group = 1), col=c("#fc6b03","#cfcaca","#f2d729","#b3190b")[unclass(as.factor(df_extended$color))])+
geom_line(data = df_extended, aes(x = data, y = predict(loess_mod_prev,type="response"), color = "LOESS model predictor", group = 1)) +
#geom_smooth(data = df_extended, aes(x = data, y = predict(loess_mod_prev,type="response"), color = "LOESS model predictor", group = 1)) +
scale_x_date(date_breaks = '5 days',
date_labels = '%Y-%m-%d') +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
loess_mod_prev <- loess(nuovi_positivi ~ ricoverati_con_sintomi_prev + nuovi_tamponi_pcr_prev + new_color_extended + var_workplace_prev, data = df_extended, span = 0.9)
ggplot() +
geom_point(data = df_extended, aes(x = data, y = nuovi_positivi, color="nuovi positivi", group = 1), col=c("#fc6b03","#cfcaca","#f2d729","#b3190b")[unclass(as.factor(df_extended$color))])+
geom_line(data = df_extended, aes(x = data, y = predict(loess_mod_prev,type="response"), color = "LOESS model predictor", group = 1)) +
#geom_smooth(data = df_extended, aes(x = data, y = predict(loess_mod_prev,type="response"), color = "LOESS model predictor", group = 1)) +
scale_x_date(date_breaks = '5 days',
date_labels = '%Y-%m-%d') +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
loess_mod_prev <- loess(nuovi_positivi ~ ricoverati_con_sintomi_prev + nuovi_tamponi_pcr_prev + new_color_extended + var_workplace_prev + isolamento_domiciliare, data = df_extended, span = 0.9)
loess_mod_prev <- loess(nuovi_positivi ~ ricoverati_con_sintomi_prev + nuovi_tamponi_pcr_prev + new_color_extended  + isolamento_domiciliare, data = df_extended, span = 0.9)
ggplot() +
geom_point(data = df_extended, aes(x = data, y = nuovi_positivi, color="nuovi positivi", group = 1), col=c("#fc6b03","#cfcaca","#f2d729","#b3190b")[unclass(as.factor(df_extended$color))])+
geom_line(data = df_extended, aes(x = data, y = predict(loess_mod_prev,type="response"), color = "LOESS model predictor", group = 1)) +
#geom_smooth(data = df_extended, aes(x = data, y = predict(loess_mod_prev,type="response"), color = "LOESS model predictor", group = 1)) +
scale_x_date(date_breaks = '5 days',
date_labels = '%Y-%m-%d') +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
loess_mod_prev <- loess(nuovi_positivi ~ ricoverati_con_sintomi_prev + + isolamento_domiciliare, data = df_extended, span = 0.9)
ggplot() +
geom_point(data = df_extended, aes(x = data, y = nuovi_positivi, color="nuovi positivi", group = 1), col=c("#fc6b03","#cfcaca","#f2d729","#b3190b")[unclass(as.factor(df_extended$color))])+
geom_line(data = df_extended, aes(x = data, y = predict(loess_mod_prev,type="response"), color = "LOESS model predictor", group = 1)) +
#geom_smooth(data = df_extended, aes(x = data, y = predict(loess_mod_prev,type="response"), color = "LOESS model predictor", group = 1)) +
scale_x_date(date_breaks = '5 days',
date_labels = '%Y-%m-%d') +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
loess_mod_prev <- loess(nuovi_positivi ~ ricoverati_con_sintomi_prev + var_workplace_prev + isolamento_domiciliare, data = df_extended, span = 0.9)
ggplot() +
geom_point(data = df_extended, aes(x = data, y = nuovi_positivi, color="nuovi positivi", group = 1), col=c("#fc6b03","#cfcaca","#f2d729","#b3190b")[unclass(as.factor(df_extended$color))])+
geom_line(data = df_extended, aes(x = data, y = predict(loess_mod_prev,type="response"), color = "LOESS model predictor", group = 1)) +
#geom_smooth(data = df_extended, aes(x = data, y = predict(loess_mod_prev,type="response"), color = "LOESS model predictor", group = 1)) +
scale_x_date(date_breaks = '5 days',
date_labels = '%Y-%m-%d') +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
loess_mod_prev <- loess(nuovi_positivi ~ ricoverati_con_sintomi_prev  + new_color_extended + var_workplace_prev + isolamento_domiciliare, data = df_extended, span = 0.9)
ggplot() +
geom_point(data = df_extended, aes(x = data, y = nuovi_positivi, color="nuovi positivi", group = 1), col=c("#fc6b03","#cfcaca","#f2d729","#b3190b")[unclass(as.factor(df_extended$color))])+
geom_line(data = df_extended, aes(x = data, y = predict(loess_mod_prev,type="response"), color = "LOESS model predictor", group = 1)) +
#geom_smooth(data = df_extended, aes(x = data, y = predict(loess_mod_prev,type="response"), color = "LOESS model predictor", group = 1)) +
scale_x_date(date_breaks = '5 days',
date_labels = '%Y-%m-%d') +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
glm_google <- glm(nuovi_positivi ~ ricoverati_con_sintomi + var_station + new_color)
glm_google <- glm(nuovi_positivi ~ ricoverati_con_sintomi + var_station + new_color, data = df)
ggplot() +
geom_point(data = df, aes(x = data , y = nuovi_positivi))
ggplot() +
geom_point(data = df, aes(x = data , y = nuovi_positivi)) +
geom_line(data = df, aes(x = data, y = predict(glm_google, newdata = df_extended, type = "response")))
ggplot() +
geom_point(data = df_extended, aes(x = data , y = nuovi_positivi)) +
geom_line(data = df_extended, aes(x = data, y = predict(glm_google, newdata = df_extended, type = "response")))
MAPE(predict(glm_google, newdata = df_extended, type="response"),df_extended$nuovi_positivi[124:137])
MAPE(predict(glm_google, newdata = df_extended, type="response")[124:137],df_extended$nuovi_positivi[124:137])
glm_google <- glm(nuovi_positivi ~ ricoverati_con_sintomi + var_station + isolamento_domiciliare+ new_color, data = df)
ggplot() +
geom_point(data = df_extended, aes(x = data , y = nuovi_positivi)) +
geom_line(data = df_extended, aes(x = data, y = predict(glm_google, newdata = df_extended, type = "response")))
MAPE(predict(glm_google, newdata = df_extended, type="response")[124:137],df_extended$nuovi_positivi[124:137])
glm_google <- glm(nuovi_positivi ~ ricoverati_con_sintomi + var_station + isolamento_domiciliare+ new_color, data = df, family = "poisson")
ggplot() +
geom_point(data = df_extended, aes(x = data , y = nuovi_positivi)) +
geom_line(data = df_extended, aes(x = data, y = predict(glm_google, newdata = df_extended, type = "response")))
MAPE(predict(glm_google, newdata = df_extended, type="response")[124:137],df_extended$nuovi_positivi[124:137])
ggplot() +
geom_point(data = df_extended, aes(x = data , y = nuovi_positivi)) +
geom_line(data = df_extended, aes(x = data, y = predict(glm_google, newdata = df_extended, type = "response")))
glm_google <- glm(nuovi_positivi ~ ricoverati_con_sintomi + var_station + new_color, data = df, family = "poisson")
ggplot() +
geom_point(data = df_extended, aes(x = data , y = nuovi_positivi)) +
geom_line(data = df_extended, aes(x = data, y = predict(glm_google, newdata = df_extended, type = "response")))
MAPE(predict(glm_google, newdata = df_extended, type="response")[124:137],df_extended$nuovi_positivi[124:137])
ggplot() +
geom_point(data = df_extended, aes(x = data , y = nuovi_positivi)) +
geom_line(data = df_extended, aes(x = data, y = predict(glm_google, newdata = df_extended, type = "response")))
glm_google <- glm(nuovi_positivi ~ ricoverati_con_sintomi + var_station + nuovi_tamponi_pcr + new_color, data = df, family = "poisson")
ggplot() +
geom_point(data = df_extended, aes(x = data , y = nuovi_positivi)) +
geom_line(data = df_extended, aes(x = data, y = predict(glm_google, newdata = df_extended, type = "response")))
MAPE(predict(glm_google, newdata = df_extended, type="response")[124:137],df_extended$nuovi_positivi[124:137])
glm_google <- glm(nuovi_positivi ~ ricoverati_con_sintomi + var_station + isolamento_domiciliare+ nuovi_tamponi_pcr + new_color, data = df, family = "poisson")
ggplot() +
geom_point(data = df_extended, aes(x = data , y = nuovi_positivi)) +
geom_line(data = df_extended, aes(x = data, y = predict(glm_google, newdata = df_extended, type = "response")))
MAPE(predict(glm_google, newdata = df_extended, type="response")[124:137],df_extended$nuovi_positivi[124:137])
glm_google <- glm(nuovi_positivi ~ ricoverati_con_sintomi + var_station + isolamento_domiciliare+ nuovi_tamponi_pcr + new_color, data = df, family = "poisson")
glm_google <- glm(nuovi_positivi ~ ricoverati_con_sintomi + var_station + isolamento_domiciliare+ nuovi_tamponi_pcr + new_color, data = df, family = "poisson")
ggplot() +
geom_point(data = df_extended, aes(x = data , y = nuovi_positivi)) +
geom_line(data = df_extended, aes(x = data, y = predict(glm_google, newdata = df_extended, type = "response")))
